(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3803"],{"2Lg3":function(t,e,o){},"9kWb":function(t,e,o){},EXL7:function(t,e,o){"use strict";var a=o("P2sY"),r=o.n(a),s=o("glbJ"),i=o("4d7F"),n=o.n(i),l=o("MSNs"),c={name:"SingleImageUpload3",props:{value:{type:String,default:""}},data:function(){return{tempUrl:"",dataObj:{token:"ji07K2FPpLxX4zHY4-k-L_vu26ZaH75c0pjeMahs:ywmlbPHBwSJUG5cqI0ux8YfdH-c=:eyJzY29wZSI6InFoYnVja2V0MSIsImRlYWRsaW5lIjoxNTQ5NzA3MzIzfQ==",key:"567"}}},computed:{imageUrl:function(){return this.value}},methods:{rmImage:function(){this.emitInput("")},emitInput:function(t){this.$emit("input",t)},handleImageSuccess:function(t){this.emitInput(t.files.file),console.log("handleImageSuccess file=",t)},handleSuccess:function(t,e){console.log("response=",t)},beforeUpload:function(){var t=this,e=this;return new n.a(function(o,a){Object(l.a)().then(function(a){var r=a.data.qiniu_key,s=a.data.qiniu_token;e._data.dataObj.token=s,e._data.dataObj.key=r,t.tempUrl=a.data.qiniu_url,o(!0)}).catch(function(t){console.log(t),a(!1)})})}}},u=(o("ST8P"),o("KHd+")),m=Object(u.a)(c,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"upload-container"},[o("el-upload",{staticClass:"image-uploader",attrs:{data:t.dataObj,multiple:!1,"show-file-list":!1,"on-success":t.handleSuccess,drag:"",action:"https://upload.qiniup.com"}},[o("i",{staticClass:"el-icon-upload"}),t._v(" "),o("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处3333，或"),o("em",[t._v("点击上传")])])]),t._v(" "),o("div",{staticClass:"image-preview image-app-preview"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.imageUrl.length>1,expression:"imageUrl.length>1"}],staticClass:"image-preview-wrapper"},[o("img",{attrs:{src:t.imageUrl}}),t._v(" "),o("div",{staticClass:"image-preview-action"},[o("i",{staticClass:"el-icon-delete",on:{click:t.rmImage}})])])]),t._v(" "),o("div",{staticClass:"image-preview"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.imageUrl.length>1,expression:"imageUrl.length>1"}],staticClass:"image-preview-wrapper"},[o("img",{attrs:{src:t.imageUrl}}),t._v(" "),o("div",{staticClass:"image-preview-action"},[o("i",{staticClass:"el-icon-delete",on:{click:t.rmImage}})])])])],1)},[],!1,null,"4e61040c",null);m.options.__file="singleImage3.vue";var p=m.exports,d=o("Grqa"),h=o("uARZ"),f=o("Yfch"),g=o("t3Un");var v=Object(u.a)({},function(){var t=this.$createElement;return(this._self._c||t)("p",{staticClass:"warn-content"},[this._v("\n  這裏的文章是發布在微信小程序上的文章。在這裏編輯相應的文章後，點擊發布即可\n  ")])},[],!1,null,null,null);v.options.__file="Warning.vue";var _=v.exports,b={props:{value:{type:Boolean,default:!1}},computed:{comment_disabled:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},w=Object(u.a)(b,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v(t._s(t.comment_disabled?"评论已关闭":"评论已打开")+"\n    "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{staticClass:"no-padding",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",[o("el-radio-group",{staticStyle:{padding:"10px"},model:{value:t.comment_disabled,callback:function(e){t.comment_disabled=e},expression:"comment_disabled"}},[o("el-radio",{attrs:{label:!0}},[t._v("关闭评论")]),t._v(" "),o("el-radio",{attrs:{label:!1}},[t._v("打开评论")])],1)],1)],1)],1)},[],!1,null,null,null);w.options.__file="Comment.vue";var F=w.exports,y={props:{value:{required:!0,default:function(){return[]},type:Array}},data:function(){return{platformsOptions:[{key:"a-platform",name:"a-platform"},{key:"b-platform",name:"b-platform"},{key:"c-platform",name:"c-platform"}]}},computed:{platforms:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},x=Object(u.a)(y,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"hide-on-click":!1,"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v("\n    平台("+t._s(t.platforms.length)+")\n    "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{staticClass:"no-border",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-checkbox-group",{staticStyle:{padding:"5px 15px"},model:{value:t.platforms,callback:function(e){t.platforms=e},expression:"platforms"}},t._l(t.platformsOptions,function(e){return o("el-checkbox",{key:e.key,attrs:{label:e.key}},[t._v("\n        "+t._s(e.name)+"\n      ")])}))],1)],1)},[],!1,null,null,null);x.options.__file="Platform.vue";var k=x.exports,C={props:{value:{type:String,default:""}},computed:{source_uri:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},S=Object(u.a)(C,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v("\n    外链\n    "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{staticClass:"no-padding no-border",staticStyle:{width:"400px"},attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{"label-width":"0px",prop:"source_uri"}},[o("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.source_uri,callback:function(e){t.source_uri=e},expression:"source_uri"}},[o("template",{slot:"prepend"},[t._v("填写url")])],2)],1)],1)],1)},[],!1,null,null,null);S.options.__file="SourceUrl.vue";var A=S.exports,$=o("pjYA"),j=o.n($);j.a.initialize("0b33e6a5efced6ba3cd345a1b1e82e84","0396365e6991fe6b1fb0f09d5447b92a");var I={status:"draft",title:"",article:"",article_short:"",source_uri:"",image_uri:"",display_time:void 0,id:void 0,platforms:["a-platform"],comment_disabled:!1,importance:0},O={name:"ArticleDetail",components:{Tinymce:s.a,MDinput:d.a,Upload:p,Sticky:h.a,Warning:_,CommentDropdown:F,PlatformDropdown:k,SourceUrlDropdown:A},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,o,a){""===o?(t.$message({message:e.field+"为必传项",type:"error"}),a(new Error(e.field+"为必传项"))):a()};return{postForm:r()({},I),loading:!1,userListOptions:[],rules:{image_uri:[{validator:e}],title:[{validator:e}],article:[{validator:e}],source_uri:[{validator:function(e,o,a){o?Object(f.b)(o)?a():(t.$message({message:"外链url填写不正确",type:"error"}),a(new Error("外链url填写不正确"))):a()},trigger:"blur"}]},tempRoute:{}}},computed:{articleShortLength:function(){return this.postForm.article_short.length},lang:function(){return this.$store.getters.language}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;console.log("id=",this.$route.params.id),this.fetchData(t)}else this.postForm=r()({},I);this.tempRoute=r()({},this.$route)},methods:{fetchData:function(t){var e=this,o=j.a.Object.extend("htmlview"),a=new j.a.Query(o);a.equalTo("index",t),a.descending("createdAt"),a.find({success:function(t){console.log("results = ",t),e.postForm=t[0].attributes,e.postForm.display_time=t[0].updatedAt,e.postForm.objectId=t[0].id,console.log("self.postForm=",e.postForm),e.setTagsViewTitle()},error:function(t){console.log("error=",t)}})},setTagsViewTitle:function(){var t="zh"===this.lang?"编辑文章":"Edit Article",e=r()({},this.tempRoute,{title:t+"-"+this.postForm.index});this.$store.dispatch("updateVisitedView",e)},submitForm:function(){var t=this,e=this;console.log(this.postForm),this.$refs.postForm.validate(function(o){if(!o)return console.log("error submit!!"),!1;t.loading=!0;var a=j.a.Object.extend("htmlview");new j.a.Query(a).get(t.postForm.objectId,{success:function(t){t.set("title",e.postForm.title),t.set("article",e.postForm.article),t.set("article_short",e.postForm.article_short),t.set("author",e.postForm.author),t.set("status","published"),t.save(),e.$notify({title:"成功",message:"更新文章成功",type:"success",duration:2e3}),e.postForm.status="published",e.loading=!1},error:function(t,e){console.log("更新文章成error = ",e)}})})},draftForm:function(){if(0!==this.postForm.article.length&&0!==this.postForm.title.length){this.$message({message:"保存成功",type:"success",showClose:!0,duration:1e3}),this.loading=!0;var t=this,e=j.a.Object.extend("htmlview");new j.a.Query(e).get(this.postForm.objectId,{success:function(e){e.set("title",t.postForm.title),e.set("article",t.postForm.article),e.set("article_short",t.postForm.article_short),e.set("author",t.postForm.author),e.set("status","draft"),e.save(),t.$notify({title:"成功",message:"保存爲草稿成功",type:"success",duration:2e3}),t.postForm.status="draft",t.loading=!1},error:function(t,e){console.log("更新文章成error = ",e)}})}else this.$message({message:"请填写必要的标题和内容",type:"warning"})},getRemoteUserList:function(t){var e=this;(function(t){return Object(g.a)({url:"/search/user",method:"get",params:{name:t}})})(t).then(function(t){t.data.items&&(e.userListOptions=t.data.items.map(function(t){return t.name}))})}}},U=(o("MUlN"),Object(u.a)(O,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"createPost-container"},[o("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[o("sticky",{attrs:{"class-name":"sub-navbar "+t.postForm.status}},[o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("發布\n      ")]),t._v(" "),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"warning"},on:{click:t.draftForm}},[t._v("草稿")])],1),t._v(" "),o("div",{staticClass:"createPost-main-container"},[o("el-row",[o("Warning"),t._v(" "),o("el-col",{attrs:{span:24}},[o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[o("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[t._v("\n              標題\n            ")])],1),t._v(" "),o("div",{staticClass:"postInfo-container"},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"45px",label:"作者:"}},[o("el-select",{attrs:{"remote-method":t.getRemoteUserList,filterable:"",remote:"",placeholder:"搜索用戶"},model:{value:t.postForm.author,callback:function(e){t.$set(t.postForm,"author",e)},expression:"postForm.author"}},t._l(t.userListOptions,function(t,e){return o("el-option",{key:t+e,attrs:{label:t,value:t}})}))],1)],1),t._v(" "),o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"80px",label:"更新時間:"}},[o("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"選擇日期時間"},model:{value:t.postForm.display_time,callback:function(e){t.$set(t.postForm,"display_time",e)},expression:"postForm.display_time"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"60px",label:"重要性:"}},[o("el-rate",{staticStyle:{"margin-top":"8px"},attrs:{max:3,colors:["#99A9BF","#F7BA2A","#FF9900"],"low-threshold":1,"high-threshold":3},model:{value:t.postForm.importance,callback:function(e){t.$set(t.postForm,"importance",e)},expression:"postForm.importance"}})],1)],1)],1)],1)],1)],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"45px",label:"摘要:"}},[o("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入内容"},model:{value:t.postForm.article_short,callback:function(e){t.$set(t.postForm,"article_short",e)},expression:"postForm.article_short"}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.articleShortLength,expression:"articleShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.articleShortLength)+"字")])],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"article"}},[o("Tinymce",{ref:"editor",attrs:{height:600},model:{value:t.postForm.article,callback:function(e){t.$set(t.postForm,"article",e)},expression:"postForm.article"}})],1)],1)],1)],1)},[],!1,null,"422ece3e",null));U.options.__file="ArticleDetail.vue";e.a=U.exports},MSNs:function(t,e,o){"use strict";o.d(e,"a",function(){return n});var a=o("gDS+"),r=o.n(a),s=(o("t3Un"),o("NFKh")),i=o.n(s);function n(){var t={scope:"qhbucket1",deadline:0},e=Math.round((new Date).getTime()/1e3)+3600;t.deadline=e,console&&console.log("deadline = ",e);var o=r()(t);console&&console.log("put_policy = ",o);var a=function(t){var e,o,a,r,s,i;a=t.length,o=0,e="";for(;o<a;){if(r=255&t.charCodeAt(o++),o==a){e+=l.charAt(r>>2),e+=l.charAt((3&r)<<4),e+="==";break}if(s=t.charCodeAt(o++),o==a){e+=l.charAt(r>>2),e+=l.charAt((3&r)<<4|(240&s)>>4),e+=l.charAt((15&s)<<2),e+="=";break}i=t.charCodeAt(o++),e+=l.charAt(r>>2),e+=l.charAt((3&r)<<4|(240&s)>>4),e+=l.charAt((15&s)<<2|(192&i)>>6),e+=l.charAt(63&i)}return e}(function(t){var e,o,a,r;for(e="",a=t.length,o=0;o<a;o++)(r=t.charCodeAt(o))>=1&&r<=127?e+=t.charAt(o):r>2047?(e+=String.fromCharCode(224|r>>12&15),e+=String.fromCharCode(128|r>>6&63),e+=String.fromCharCode(128|r>>0&63)):(e+=String.fromCharCode(192|r>>6&31),e+=String.fromCharCode(128|r>>0&63));return e}(o));console&&console.log("encoded = ",a);var s=i.a.HmacSHA1(a,"gjKrCsQvSU6XNyVvNqwkWoHlSv8ff2MQ6SoS9biL").toString(i.a.enc.Base64);console&&console.log("encoded_signed=",s);var n="ji07K2FPpLxX4zHY4-k-L_vu26ZaH75c0pjeMahs:"+c(s)+":"+a;return console&&console.log("upload_token=",n),n}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);var c=function(t){return t=(t=t.replace(/\+/g,"-")).replace(/\//g,"_")}},MUlN:function(t,e,o){"use strict";var a=o("2Lg3");o.n(a).a},ST8P:function(t,e,o){"use strict";var a=o("9kWb");o.n(a).a},Yfch:function(t,e,o){"use strict";function a(t){return["admin","editor"].indexOf(t.trim())>=0}function r(t){return/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(t)}o.d(e,"a",function(){return a}),o.d(e,"b",function(){return r})}}]);